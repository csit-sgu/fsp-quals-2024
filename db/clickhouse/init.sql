CREATE TABLE db.events (
    code String NOT NULL,
    sport String NOT NULL,
    title String NOT NULL,
    additional_info String,
    n_participants UInt32 NOT NULL,
    stage String NOT NULL,
    start_date Date NOT NULL,
    end_date Date NOT NULL,
)
ENGINE = MergeTree()
ORDER BY (sport, start_date, code);

CREATE TABLE db.age_restrictions (
    code String NOT NULL,
    gender Enum('male' = 1, 'female' = 2) NOT NULL,
    left_bound UInt32 NOT NULL,
    right_bound UInt32 NOT NULL,
    extra_mapping String,
)
ENGINE = MergeTree()
ORDER BY (left_bound, right_bound, code);

CREATE TABLE db.location_restrictions (
    code String NOT NULL,
    country String NOT NULL,
    region String NOT NULL,
    locality String NOT NULL,
)
ENGINE = MergeTree()
ORDER BY (country, region, locality, code);

INSERT INTO db.events (code, title, sport, additional_info, n_participants, stage, start_date, end_date)
VALUES
    ('100001', 'Гаражный чемпионат', 'Прыжки через гаражи', 'Прыжки через гаражи, до 70 кг', 150, 'Чемпионат двора', '2024-12-01 12:00:00', '2024-12-02 18:00:00'),
    ('100002', 'Угольный забег', 'Бег по раскалённым углям', 'На скорость и грацию', 75, 'Междворовой турнир', '2024-12-15 10:00:00', '2024-12-15 15:00:00'),
    ('100003', 'Табуреточные гонки', 'Катание на табуретках', 'С препятствиями, до 90 кг', 120, 'Кубок Тюмени', '2025-01-10 09:00:00', '2025-01-12 17:00:00'),
    ('100004', 'Самоварный подъем', 'Поднятие самоваров', 'Слева и справа', 60, 'Самоварный баттл', '2025-02-20 11:00:00', '2025-02-21 13:00:00'),
    ('100005', 'Борьба на качелях', 'Борьба на качелях', 'С прыжками и подсечками', 85, 'Финал России', '2025-03-05 14:00:00', '2025-03-06 16:00:00'),
    ('100006', 'Котоборье', 'Перетягивание кота', 'На выносливость', 50, 'Дворовая лига', '2025-04-01 08:00:00', '2025-04-01 12:00:00'),
    ('100007', 'Утюжные забеги', 'Бег с утюгами', 'На скорость и чистоту', 140, 'Кубок Утюга', '2025-05-10 07:00:00', '2025-05-11 20:00:00'),
    ('100008', 'Мётловые гонки', 'Гонки на метлах', 'С фигурами пилотажа', 95, 'Межрегиональные старты', '2025-06-15 09:30:00', '2025-06-15 14:30:00'),
    ('100009', 'Толкачи самосвалов', 'Толкание самосвала', 'В горку, до 100 кг', 200, 'Железный чемпионат', '2025-07-25 10:00:00', '2025-07-27 18:00:00'),
    ('100010', 'Каблучный спринт', 'Бег на каблуках', '100 метровка', 130, 'Чемпионат Юга', '2025-08-20 16:00:00', '2025-08-20 19:00:00'),
    ('100011', 'Тапки на меткость', 'Метание тапков', 'На дальность', 180, 'Кубок тапка', '2025-09-10 12:00:00', '2025-09-10 16:00:00'),
    ('100012', 'Гладильный турнир', 'Соревнования по глажке', 'На скорость и аккуратность', 100, 'Гладильный турнир', '2025-10-05 08:00:00', '2025-10-06 14:00:00'),
    ('100013', 'Велосипедные перетяжки', 'Перетягивание каната на велосипедах', 'С элементами акробатики', 110, 'Кубок Байкала', '2025-11-15 13:00:00', '2025-11-16 17:00:00'),
    ('100014', 'Скандинавский марафон', 'Марафон по скандинавской ходьбе', 'По песку и болоту', 65, 'Марафон Балтики', '2025-12-10 07:00:00', '2025-12-10 21:00:00'),
    ('100015', 'Подводные шахматы', 'Подводное шахматное дерби', 'Шахматы в акваланге', 40, 'Чемпионат Приморья', '2025-12-20 10:00:00', '2025-12-21 18:00:00'),
    ('100016', 'Скалолазание на шкафы', 'Скалолазание на шкафы', 'На скорость', 90, 'Кубок Казани', '2026-01-15 09:00:00', '2026-01-15 17:00:00');

INSERT INTO db.age_restrictions (code, gender, left_bound, right_bound, extra_mapping)
VALUES
    ('100001', 'male', 16, 60, 'мужчина'),
    ('100002', 'female', 18, 50, 'женщина'),
    ('100003', 'male', 20, 90, 'мужчина'),
    ('100004', 'female', 18, 50, 'женщина'),
    ('100005', 'male', 22, 80, 'мужчина'),
    ('100006', 'female', 15, 30, 'девушка'),
    ('100007', 'male', 19, 45, 'мужчина'),
    ('100008', 'female', 18, 60, 'женщина'),
    ('100009', 'male', 25, 100, 'ветеран'),
    ('100010', 'female', 21, 40, 'женщина'),
    ('100011', 'male', 16, 45, 'мужчина'),
    ('100012', 'female', 18, 50, 'женщина'),
    ('100013', 'male', 20, 60, 'мужчина'),
    ('100014', 'female', 25, 55, 'ветеранка'),
    ('100015', 'male', 18, 45, 'мужчина'),
    ('100016', 'female', 20, 60, 'женщина');

INSERT INTO db.location_restrictions (code, country, region, locality)
VALUES
    ('100001', 'Россия', 'Московская область', 'г. Москва'),
    ('100001', 'Россия', 'Ленинградская область', 'г. Санкт-Петербург'),
    ('100002', 'США', 'Калифорния', 'г. Лос-Анджелес'),
    ('100002', 'США', 'Невада', 'г. Лас-Вегас'),
    ('100003', 'Канада', 'Альберта', 'г. Калгари'),
    ('100003', 'Канада', 'Британская Колумбия', 'г. Ванкувер'),
    ('100004', 'Италия', 'Тоскана', 'г. Флоренция'),
    ('100004', 'Италия', 'Лацио', 'г. Рим'),
    ('100005', 'Германия', 'Бавария', 'г. Мюнхен'),
    ('100005', 'Германия', 'Северный Рейн-Вестфалия', 'г. Дюссельдорф'),
    ('100006', 'Франция', 'Иль-де-Франс', 'г. Париж'),
    ('100006', 'Франция', 'Прованс', 'г. Марсель'),
    ('100007', 'Испания', 'Каталония', 'г. Барселона'),
    ('100007', 'Испания', 'Мадрид', 'г. Мадрид'),
    ('100008', 'Великобритания', 'Англия', 'г. Лондон'),
    ('100008', 'Великобритания', 'Шотландия', 'г. Эдинбург'),
    ('100009', 'Австралия', 'Новый Южный Уэльс', 'г. Сидней'),
    ('100009', 'Австралия', 'Виктория', 'г. Мельбурн'),
    ('100010', 'Китай', 'Пекин', 'г. Пекин'),
    ('100010', 'Китай', 'Шанхай', 'г. Шанхай'),
    ('100011', 'Япония', 'Токио', 'г. Токио'),
    ('100011', 'Япония', 'Осака', 'г. Осака'),
    ('100012', 'Швейцария', 'Тичино', 'г. Лугано'),
    ('100012', 'Швейцария', 'Женева', 'г. Женева'),
    ('100013', 'Бразилия', 'Рио-де-Жанейро', 'г. Рио-де-Жанейро'),
    ('100013', 'Бразилия', 'Сан-Паулу', 'г. Сан-Паулу'),
    ('100014', 'Индия', 'Махараштра', 'г. Мумбаи'),
    ('100014', 'Индия', 'Дели', 'г. Дели'),
    ('100015', 'ЮАР', 'Гаутенг', 'г. Йоханнесбург'),
    ('100015', 'ЮАР', 'Западный Кейп', 'г. Кейптаун'),
    ('100016', 'Мексика', 'Сьюдад-де-Мексико', 'г. Мехико'),
    ('100016', 'Мексика', 'Халиско', 'г. Гвадалахара');


CREATE VIEW db.general_view
AS
SELECT
	e.code as code, start_date, country, region, title, additional_info, n_participants, stage, end_date
FROM
    db.events AS e
INNER JOIN
    db.location_restrictions AS l
ON e.code = l.code
INNER JOIN
    db.age_restrictions AS a
ON e.code = a.code
